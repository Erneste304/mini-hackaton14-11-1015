{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="row g-0 justify-content-center py-3">

  <!-- Left Info Panel -->
  <div class="col-lg-5 d-none d-lg-flex flex-column justify-content-center p-5"
    style="background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); border-radius: 16px 0 0 16px; color:#fff; min-height:600px;">
    <div>
      <div class="mb-4" style="font-size:3rem;">🛒</div>
      <h2 class="fw-bold mb-3">Join Soko Hub Today</h2>
      <p class="mb-4 opacity-75" style="font-size:1rem; line-height:1.7;">
        Rwanda's growing online marketplace. Connect with hundreds of vendors and thousands of products — all in one
        place.
      </p>

      <div class="d-flex flex-column gap-3">
        <div class="d-flex align-items-start gap-3">
          <span style="font-size:1.4rem;">✅</span>
          <div>
            <div class="fw-semibold">Free to Register</div>
            <div class="opacity-75 small">Create your account in under 2 minutes</div>
          </div>
        </div>
        <div class="d-flex align-items-start gap-3">
          <span style="font-size:1.4rem;">🔒</span>
          <div>
            <div class="fw-semibold">Secure & Verified</div>
            <div class="opacity-75 small">Email OTP verification protects your account</div>
          </div>
        </div>
        <div class="d-flex align-items-start gap-3">
          <span style="font-size:1.4rem;">🏪</span>
          <div>
            <div class="fw-semibold">Vendors & Buyers Welcome</div>
            <div class="opacity-75 small">Shop or list your products — your choice</div>
          </div>
        </div>
        <div class="d-flex align-items-start gap-3">
          <span style="font-size:1.4rem;">🚚</span>
          <div>
            <div class="fw-semibold">Fast Delivery</div>
            <div class="opacity-75 small">Track your orders in real time</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right Form Panel -->
  <div class="col-md-9 col-lg-7">
    <div class="card shadow-lg border-0 h-100" style="border-radius: 0 16px 16px 0;">
      <div class="card-header bg-white border-0 pt-4 pb-0 px-4 px-lg-5">
        <h4 class="fw-bold text-primary mb-0">Create Account</h4>
        <p class="text-muted small mb-0">Fill in the details below — takes less than 2 minutes</p>
      </div>

      <div class="card-body px-4 px-lg-5 py-3">
        <form method="post" enctype="multipart/form-data">
          {% csrf_token %}

          <!-- User Type Cards -->
          <div class="mb-3">
            <label class="form-label fw-semibold text-secondary small text-uppercase">I want to:</label>
            <div class="row g-2">
              <div class="col-6">
                <label class="w-100 cursor-pointer" for="type-customer">
                  <input type="radio" name="user_type" value="customer" id="type-customer" class="btn-check" checked />
                  <div class="card text-center p-3 border-2 role-card" id="card-customer"
                    style="border-radius:10px; cursor:pointer; transition:all .2s;">
                    <div style="font-size:1.6rem;">🛒</div>
                    <div class="fw-semibold small mt-1">Buy Products</div>
                    <div class="text-muted" style="font-size:11px;">Shop from vendors</div>
                  </div>
                </label>
              </div>
              <div class="col-6">
                <label class="w-100 cursor-pointer" for="type-vendor">
                  <input type="radio" name="user_type" value="vendor" id="type-vendor" class="btn-check" />
                  <div class="card text-center p-3 border-2 role-card" id="card-vendor"
                    style="border-radius:10px; cursor:pointer; transition:all .2s;">
                    <div style="font-size:1.6rem;">🏪</div>
                    <div class="fw-semibold small mt-1">Sell Products</div>
                    <div class="text-muted" style="font-size:11px;">List your products</div>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <!-- Fields -->
          <div class="row g-2">
            <div class="col-md-6">{{ form.username|as_crispy_field }}</div>
            <div class="col-md-6">{{ form.email|as_crispy_field }}</div>
            <div class="col-md-6">{{ form.phone|as_crispy_field }}</div>
            <div class="col-md-6">{{ form.location|as_crispy_field }}</div>
            <div class="col-12">{{ form.profile_picture|as_crispy_field }}</div>
            <div class="col-md-6">{{ form.password1|as_crispy_field }}</div>
            <div class="col-md-6">{{ form.password2|as_crispy_field }}</div>
          </div>

          <!-- Note about OTP -->
          <div class="alert alert-info py-2 px-3 mb-3" style="border-radius:8px; font-size:13px;">
            <i class="fas fa-envelope me-1"></i>
            After registering, you'll receive a <strong>6-digit verification code</strong> by email to activate your
            account.
          </div>

          <button type="submit" class="btn btn-primary btn-lg w-100 fw-semibold"
            style="border-radius:10px; letter-spacing:.5px;">
            <i class="fas fa-user-plus me-2"></i>Create Account
          </button>
        </form>

        <hr class="my-3" />

        <div class="text-center">
          <span class="text-muted small">Already have an account?</span>
          <a href="{% url 'login' %}" class="fw-bold ms-1">Sign in here</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  // Role card highlight
  function updateCards() {
    const custChecked = document.getElementById('type-customer').checked;
    document.getElementById('card-customer').style.borderColor = custChecked ? '#007bff' : '#dee2e6';
    document.getElementById('card-customer').style.background = custChecked ? '#f0f7ff' : '#fff';
    document.getElementById('card-vendor').style.borderColor = custChecked ? '#dee2e6' : '#007bff';
    document.getElementById('card-vendor').style.background = custChecked ? '#fff' : '#f0f7ff';
  }
  document.getElementById('type-customer').addEventListener('change', updateCards);
  document.getElementById('type-vendor').addEventListener('change', updateCards);
  updateCards();
</script>
{% endblock %}